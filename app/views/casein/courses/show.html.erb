<!-- Scaffolding generated by Casein v5.1.1.5 -->

<h2>View course</h2>

<div class='row'>
	<div class = 'col-lg-10'>
		<%= form_for @course, :url => casein_course_path(@course), html: {multipart: true} do |f| %>

			<%= render :partial => 'casein/courses/form', :locals => { :f => f } %>
	
			<p class="submits">
	  		<%= link_to 'Cancel', casein_courses_path, :class => 'btn btn-mini btn-danger' %>
			<%= f.submit "Save as draft", name: 'draft', :class => "btn btn-mini btn-info" %>
			<%= f.submit "Submit for approval", name: 'submit', :class => 'btn btn-mini btn-success' %>
			<%= f.submit "Approve", name: 'approve', :class => 'btn btn-mini btn-success' %>
			<%= f.submit "Publish", name: 'publish', :class => 'btn btn-mini btn-primary' %>
			</p>

		<% end %>
	</div>
	<div class = 'col-lg-2'>
		<%= render partial: 'casein/photos/photo_upload', object: @course, as: :imageable %>
	</div>
</div>

	<div class = '.container-fluid'>
		<%= form_tag update_multiple_casein_photos_path do %>
		<label class = 'control-label'>Current <%= @course.name %> photos </label>
			<% if @course.photos.present? %>

				<%= render partial: 'casein/photos/photo_multi_edit', object: @course, as: :imageable %>
			
			<% else %>
				<br />
				<i>There are currently no photos for <%= @course.name %></i>
			<% end %>
		<% end %>
	</div>


<%= content_for :sidebar do %>
	<li><%= link_to "#{casein_show_icon "th-list"}Back to list".html_safe, casein_courses_path %></li>
	<li><%= link_to "#{casein_show_icon "plus-sign"}Add Photos from Gallery".html_safe, '#', data: { toggle: 'modal', target: '#myModal'} %></li>
	<%= simple_form_for @course, :url => casein_course_path(@course), remote: true do |f| %>
	<%= f.input :workflow_state, as: :select, :collection => Course.workflow_spec.state_names  %>
	<%= f.button :submit, 'state' %>
	<% end %>
<% end %>

<%= render partial: 'casein/photos/photo_modal_gallary', object: @course, as: :imageable %>

<script>
	$(document).ready(function() {
		Dropzone.options.myAwesomeDropzone = {
			init: function() {
				this.on("thumbnail", function (file) {
					$(".dz-image img").addClass("img-responsive");
				});
			},
			paramName: 'photo[image]',
			uploadMultiple: false,
			clickable: true,
			acceptedFiles: 'image/*',
			thumbnailWidth: '160',
			thumbnailHeight: '160'
		};

    
		$('.sub-btn').prop('disabled', true);
		$(".container .cbox").hide();
		$('.image-select').click(function() {
			var $checkbox = $(this).parent().find('.cbox');
			$(this).toggleClass('selected');
			$checkbox.prop('checked', !$checkbox.prop('checked'));
			$('.sub-btn').prop('disabled', !$('.cbox:checked').length);
		});
		$('.box').on('change', function () {
    		$('.sub-btn').prop('disabled', !$('.cbox:checked').length);
		}).change();

	})
</script>