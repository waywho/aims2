<!-- Scaffolding generated by Casein v5.1.1.5 -->

<table class="table table-striped table-hover table-condensed sortable-table">
	<thead>
		<tr>
			<th><%= check_box_tag 'multi' %></th>
			<th><%= casein_sort_link "Title", :title %></th>
			<th><%= casein_sort_link "Course Format", :courseformat_id %></th>
			<th><%= casein_sort_link "Publish Date", :published_at %></th>
			<th><%= casein_sort_link "Updated at", :updated_at %></th>
			<th><%= casein_sort_link "Status", :workflow_state %></th>
			<th>&nbsp;</th>
		</tr>
	</thead>
	
	<% courses.each do |course| %>
		<tr data-update-url=<%= casein_course_path(course) %>>
			<td><%= check_box_tag 'course[course_ids][]', course.id, checked = false, { id: dom_id(course), :class => 'index-check' } %>
			</td>			
			<td><%= casein_table_cell_link course.title, casein_course_path(course) %></td>
			<td><%= casein_table_cell_link course.courseformat.title, casein_course_path(course) if course.courseformat_id.present? %></td>
			<td><%= casein_table_cell_link d_m_y(course.published_at), casein_course_path(course) %></td>
			<td><%= casein_table_cell_link d_m_y(course.updated_at), casein_course_path(course) %></td>
			<td><%= link_to casein_course_path(course) do %>
				<%= image_tag state_icon(course.workflow_state) %>
				<% end %>
			</td>

			
			<td class="delete">
				<%= link_to(casein_show_row_icon("trash"), casein_course_path(course), :method => :delete ) %>
			</td>
		</tr>
	<% end %>
</table>

<script>
	var fixHelper = function(e, ui) {
		ui.children().each(function() {
			$(this).width($(this).width());
		});
		return ui;
	};
	$(function() {
		$('.sortable-table tbody').sortable({
			helper: fixHelper,
			update: function(event, ui) {
				$.ajax({
					type: 'PUT',
					url: ui.item.data('update-url'),
					dataType: 'json',
					data: { course: {row_order_position: ui.item.index()}}
				});
			}
		});
	});
</script>