<!-- Scaffolding generated by Casein v5.1.1.5 -->

<table class="table table-striped table-hover table-condensed sortable-table">
	<thead>
		<tr>
			<th><%= check_box_tag 'multi' %></th>
			<th><%= casein_sort_link "Title", :title %></th>
			<th><%= casein_sort_link "# of sessions", :number_of_sessions %></th>
			<th><%= casein_sort_link "Session of day", :session_of_day %></th>
			<th><%= casein_sort_link "Course", :course_title %></th>
			<th><%= casein_sort_link "Publish Date", :published_at %></th>
			<th><%= casein_sort_link "Updated at", :updated_at %></th>
			<th><%= casein_sort_link "Status", :workflow_state %></th>
			<th>&nbsp;</th>
		</tr>
	</thead>
	
		<% klasses.each do |klass| %>
			<tr data-update-url=<%= casein_klass_path(klass) %>>
				<td><%= check_box_tag 'klass[klass_ids][]', klass.id, checked = false, { id: dom_id(klass), :class => 'index-check' } %>
				</td>
				<td><%= casein_table_cell_link klass.title, casein_klass_path(klass) %></td>
				<td><%= casein_table_cell_link klass.number_of_sessions, casein_klass_path(klass) %></td>
				<td><%= casein_table_cell_link klass.session_of_day, casein_klass_path(klass) %></td>
				<td><%= casein_table_cell_link klass.course.title, casein_klass_path(klass) if klass.course.present? %></td>
				<td><%= casein_table_cell_link d_m_y(klass.published_at), casein_klass_path(klass) %></td>	
				<td><%= casein_table_cell_link d_m_y(klass.updated_at), casein_klass_path(klass) %></td>
				<td><%= link_to casein_klass_path(klass) do %>
					<%= image_tag state_icon(klass.workflow_state) %>
					<% end %>
				</td>
				<td class="delete">
					<%= link_to(casein_show_row_icon("trash"), casein_klass_path(klass), :method => :delete, :data => { :confirm => "Are you sure you want to delete this klass?" }) %>
				</td>
			</tr>
		<% end %>				
</table>

<script>
	var fixHelper = function(e, ui) {
		ui.children().each(function() {
			$(this).width($(this).width());
		});
		return ui;
	};
	$(function() {
		$('.sortable-table tbody').sortable({
			helper: fixHelper,
			update: function(event, ui) {
				$.ajax({
					type: 'PUT',
					url: ui.item.data('update-url'),
					dataType: 'json',
					data: { klass: {row_order_position: ui.item.index()}}
				});
			}
		});
	});
</script>