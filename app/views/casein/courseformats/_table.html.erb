<!-- Scaffolding generated by Casein v5.1.1.5 -->

<table class="table table-striped table-hover table-condensed sortable-table">
	<thead>
		<tr>
			<th><%= check_box_tag 'multi' %></th>
			<th><%= casein_sort_link "Title", :title %></th>
			<th><%= casein_sort_link "Date", :date %></th>
			<th><%= casein_sort_link "Venue", :venue %></th>
			<th><%= casein_sort_link "Homepage", :feature %></th>
			<th><%= casein_sort_link "Publish Date", :published_at %></th>
			<th><%= casein_sort_link "Updated at", :updated_at %></th>
			<th><%= casein_sort_link "Status", :workflow_state %></th>
			<th>&nbsp;</th>
		</tr>
	</thead>
	
	<% courseformats.each do |courseformat| %>
		<tr data-update-url=<%= casein_courseformat_path(courseformat)%>>
			<td><%= check_box_tag 'courseformat[courseformat_ids][]', courseformat.id, checked = false, { id: dom_id(courseformat), :class => 'index-check' } %>
			</td>		
			<td><%= casein_table_cell_link courseformat.title, casein_courseformat_path(courseformat) %></td>
			<td><%= casein_table_cell_link from_to(courseformat.when_from, courseformat.when_to), casein_courseformat_path(courseformat) %></td>
			<td><%= casein_table_cell_link courseformat.venue, casein_courseformat_path(courseformat) %></td>
			<td><%= link_to casein_courseformat_path(courseformat) do %>
			<%= image_tag 'check.png', :class=>'true-check img-responsive' if courseformat.feature %>
			<% end %></td>
			<td><%= casein_table_cell_link d_m_y(courseformat.published_at), casein_courseformat_path(courseformat) %></td>
			<td><%= casein_table_cell_link d_m_y(courseformat.updated_at), casein_courseformat_path(courseformat) %></td>
			<td><%= link_to casein_courseformat_path(courseformat) do %>
				<%= image_tag state_icon(courseformat.workflow_state) %>
				<% end %></td>

			<td class="delete">
				<%= link_to(casein_show_row_icon("trash"), casein_courseformat_path(courseformat), :method => :delete, :data => { :confirm => "Are you sure you want to delete this course format?" }) %>
			</td>
		</tr>
	<% end %>
</table>

<script>
	var fixHelper = function(e, ui) {
		ui.children().each(function() {
			$(this).width($(this).width());
		});
		return ui;
	};
	$(function() {
		$('.sortable-table tbody').sortable({
			helper: fixHelper,
			update: function(event, ui) {
				$.ajax({
					type: 'PUT',
					url: ui.item.data('update-url'),
					dataType: 'json',
					data: { courseformat: {row_order_position: ui.item.index()}}
				});
			}
		});
	});
</script>